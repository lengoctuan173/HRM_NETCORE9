<!-- Video call container -->
<div id="loadVideo" class="video-call-container d-none">
    <div class="video-grid">
        <div class="video-item local-video-container">
            <video id="localVideo" autoplay muted playsinline></video>
            <div class="video-controls">
                <button id="toggleMicButton" class="btn btn-outline-secondary btn-icon">
                    <i class="fas fa-microphone"></i>
                </button>
                <button id="endCallButton" class="btn btn-danger btn-icon">
                    <i class="fas fa-phone-slash"></i>
                </button>
                <button id="toggleSpeakerButton" class="btn btn-outline-secondary btn-icon">
                    <i class="fas fa-volume-up"></i>
                </button>
            </div>
        </div>
        <div class="video-item remote-video-container">
            <video id="remoteVideo" autoplay playsinline></video>
            <div id="audioOnlyMessage" style="display: none; position: absolute; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.8); color: white; z-index: 10; flex-direction: column; align-items: center; justify-content: center;">
                <i class="fas fa-phone fa-3x" style="margin-bottom: 15px;"></i>
                <div style="font-size: 18px;">Cuộc gọi chỉ có âm thanh</div>
                <div style="font-size: 14px; margin-top: 5px; opacity: 0.8;">Cuộc gọi vẫn đang diễn ra</div>
            </div>
            <div class="video-status">
                <span id="connectionStatus"></span>
                <span id="timeoutCounter"></span>
            </div>
        </div>
    </div>
</div>

<!-- Incoming Call Modal -->
<div class="modal fade" id="callModal" tabindex="-1" role="dialog" aria-labelledby="callModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-body text-center p-4" id="incoming-call">
                <div class="mb-4">
                    <i class="fas fa-phone-volume fa-3x text-primary"></i>
                </div>
                <h4 class="mb-3">Cuộc gọi đến</h4>
                <p class="mb-4">Từ <span id="callerName" class="font-weight-bold"></span></p>
                <div class="d-flex justify-content-center gap-3">
                    <button id="acceptCallButton" class="btn btn-success btn-lg mx-2">
                        <i class="fas fa-phone"></i> Chấp nhận
                    </button>
                    <button id="rejectCallButton" class="btn btn-danger btn-lg mx-2">
                        <i class="fas fa-phone-slash"></i> Từ chối
                    </button>
                </div>
                <div class="mt-3">
                    <span id="timeoutCounter" class="text-muted"></span>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.video-call-container {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.9);
    z-index: 9999;
    display: flex;
    align-items: center;
    justify-content: center;
}

.video-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 20px;
    width: 100%;
    max-width: 1200px;
    padding: 20px;
}

.video-item {
    position: relative;
    width: 100%;
    aspect-ratio: 16/9;
    background: #1a1a1a;
    border-radius: 8px;
    overflow: hidden;
}

.video-item video {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.video-controls {
    position: absolute;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    gap: 10px;
    z-index: 1;
}

.btn-icon {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
}

.video-status {
    position: absolute;
    top: 10px;
    left: 10px;
    color: white;
    text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
}

/* Modal styles */
#callModal .modal-content {
    background: #fff;
    border-radius: 15px;
    border: none;
}

#callModal .modal-body {
    padding: 2rem;
}

#callModal .btn {
    padding: 0.75rem 1.5rem;
    border-radius: 50px;
}

#callModal .btn i {
    margin-right: 8px;
}

#timeoutCounter {
    font-size: 0.9rem;
}

.gap-3 {
    gap: 1rem;
}

</style>